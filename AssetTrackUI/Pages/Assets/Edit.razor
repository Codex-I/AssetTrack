@page "/Assets/edit"
@using AssetTrackUI.Models

<Title>Create An Asset</Title>
<div class="container mt-5">
    <Card HeaderTitle="Asset Details">
        <Body>

            <EditForm Model="Model" OnValidSubmit="Submit" FormName="@formName">

                <div class="col-md-6 mb-3">
                    <label for="Name" class="form-label">Asset Name</label>
                    <InputText id="Name" @bind-Value="Model.Name" class="form-control" placeholder="Asset name" />
                </div>
                <div class="col-md-6 mb-3">
                    <label for="Id" class="form-label">Asset ID</label>
                    <InputNumber id="Id" @bind-Value="Model.Id" class="form-control" placeholder="Asset ID will be generated by the system" disabled />
                </div>

                <div class="mb-3">
                    <label class="form-label">Asset Transfer Approval</label>
                    <div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="transferApproval" id="approvalNo" value="no" checked>
                            <label class="form-check-label" for="approvalNo">No</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="transferApproval" id="approvalYes" value="yes">
                            <label class="form-check-label" for="approvalYes">Yes</label>
                        </div>
                    </div>
                </div>

                <!-- Type of Asset Upload -->
                <div class="mb-3">
                    <label class="form-label">Type of Asset Upload</label>
                    <div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" @onclick="() => ToggleAssetType(false)" name="assetUploadType" id="singleAsset" value="single" checked>
                            <label class="form-check-label" for="singleAsset">Single asset</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" @onclick="() => ToggleAssetType(true)" name="assetUploadType" id="multipleAsset" value="multiple">
                            <label class="form-check-label" for="multipleAsset">Multiple assets</label>
                        </div>
                    </div>
                </div>
                @if (isMultipleAsset)
                {

                    <div class="col-md-6 mb-3">
                        <label for="Identifier" class="form-label">Number of Assets</label>
                        <InputText id="Identifier" @bind-Value="Model.Identifier" class="form-control" placeholder="Enter number of assets" min="1" />
                    </div>
                }

                <!-- Category -->
                <div class="mb-3">
                    <label for="category" class="form-label">Category</label>
                    <div class="row">
                        <div class=" col-md-6">
                            <select class="form-select" id="category">
                                <option selected>Asset category</option>
                                <option value="1">Category 1</option>
                                <option value="2">Category 2</option>
                            </select>
                        </div>
                        <button class="btn btn-link col-md" style="text-decoration: none!important;" @onclick="categoryEdit.OpenOffCanvas">+ New category</button>
                    </div>
                </div>

                @* Location *@
                <div class="mb-3">
                    <label for="location" class="form-label">Location</label>
                    <div class="row">
                        <div class=" col-md-6">
                            <select class="form-select" id="category">
                                <option selected>Asset Location</option>
                                <option value="1">Location 1</option>
                                <option value="2">Location 2</option>
                            </select>
                        </div>
                        <button class="btn btn-link col-md" style="text-decoration: none!important;" @onclick="locationEdit.OpenOffCanvas">+ New location</button>
                    </div>
                </div>


                  <!-- Offcanvas Component for New Location -->
    
              

                <!-- Department -->

              @*   <div class="mb-3">
                    <label for="department" class="form-label">Department</label>
                    <div class="row">
                        <div class="col-md-6">
                            <select class="form-select" id="department">
                                <option selected>Location department</option>
                                <option value="1">Department 1</option>
                                <option value="2">Department 2</option>
                            </select>
                        </div>
                        <button class="btn btn-link col-md" style="text-decoration: none!important;">+ New department</button>
                    </div>
                </div> *@

                <!-- Status -->

                <div class="mb-3">
                    <label for="status" class="form-label">Status</label>
                    <div class="row">
                        <div class="col-md-6">
                            <select class="form-select" id="status">
                                <option selected>Asset status</option>
                                <option value="1">Active</option>
                                <option value="2">Maintenance</option>
                            </select>
                        </div>
                        <button class="btn btn-link col-md" style="text-decoration: none!important;" @onclick="statusEdit.OpenOffCanvas">+ New Status</button>
                    </div>
                </div>
                <!-- Note -->
                <div class="mb-3 col-md-10">
                    <label for="note" class="form-label">Note</label>
                    <textarea class="form-control" id="note" rows="3" placeholder="Asset note"></textarea>
                </div>

                <!-- Save Button -->
                <div class="col-md-6">
                    <button type="submit" class="btn btn-primary">Save new asset</button>
                </div>
            </EditForm>


        </Body>
    </Card>
   
</div>

<CategoryEdit @ref="categoryEdit"></CategoryEdit>
<LocationEdit @ref="locationEdit"></LocationEdit>
<StatusEdit @ref="statusEdit"></StatusEdit>
@code {
    private bool isMultipleAsset = false;
    private Asset Model = new();
    private string? formName;
    private CategoryEdit categoryEdit = new();
    private LocationEdit locationEdit = new();
    private StatusEdit statusEdit = new();

    // Toggle the visibility of the input field based on selection
    private void ToggleAssetType(bool isMultiple)
    {
        isMultipleAsset = isMultiple;
    }
    private async Task Submit()
    {
        try
        {
            // switch (isEdit)
            // {
            //     case 0:
            //         await TryInvokeAsync(OnCreate, "Create");
            //         break;
            //     case 1:
            //         await TryInvokeAsync(OnUpdate, "Update");
            //         break;
            //     default:
            //         await TryInvokeAsync(OnDelete, "Delete");
            //         break;
            // }
            // await alert.Success($"Operation was successful", "Success");
            // tcs?.SetResult(true);
            // hideModal = true;
        }
        catch (Exception ex)
        {
            await alert.Error(ex.FormatApiMessage(), "Error");
        }
    }
}
